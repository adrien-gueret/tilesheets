{"version":3,"sources":["../src/models/Scene.js","../src/models/Sprite.js","../src/models/Palette.js","../src/models/Tilesheet.js","../index.js","scripts/favicon.ts","scripts/tilesheet_bush.ts","scripts/tilesheet_index_sample.ts","scripts/tilesheet_advanced.ts","scripts/scene_sample.ts","scripts/sprite_animated.ts","scripts/paletted_sprite.ts","index.ts"],"names":["__read","o","n","m","Symbol","iterator","i","r","e","call","ar","next","done","push","value","error","__spread","arguments","length","concat","cloneDeepArrays","arraysToClone","map","arr","slice","Object","defineProperty","exports","Scene","tiles","canvas","timer","window","animationClocks","initialTiles","prototype","getWidth","width","tilesheet","getTileSize","Math","max","apply","row","getHeight","height","getCanvas","setCanvas","resizeCanvas","setTile","x","y","newTile","renderTile","columnIndex","rowIndex","deltaX","deltaY","ctx","getContext","tileIndex","_a","getTileRect","destX","destY","clearRect","drawImage","getImage","render","_this","Error","forEach","rowTiles","resetTiles","updateTilesFromArray","currentTileIndex","nextTileIndex","playAnimations","stopAnimations","getAnimations","animation","setInterval","speed","clock","clearInterval","useTilesheet","default","Sprite","palette","setCurrentTile","stopAnimation","animationClock","shouldLoop","onUpdate","onEnd","shouldRender","playAnimation","name","getAnimation","currentAnimationIndex","firstTile","usePalette","areColorsEqual","color1","color2","every","index","Palette","colors","addColor","color","hasColor","colorToFind","some","getColorByIndex","getIndexFromColor","findIndex","__assign","assign","t","s","p","hasOwnProperty","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","rejected","result","adopt","then","__generator","body","_","f","g","label","sent","trys","ops","verb","v","op","TypeError","pop","Palette_1","require","Tilesheet","imagePath","shouldAutoload","tileWidth","tileHeight","margin","animations","referencePalette","palettedImages","Map","image","Image","load","src","filter","setAnimations","setTileSize","setMargin","generatePalettedImage","complete","getReferencePalette","initNewCanvasWithImage","palettedImage","imageData","pixelData","data","l","red","_b","newRed","newGreen","newBlue","newAlpha","putImageData","set","paletteToUse","has","get","naturalWidth","totalTilesOnRow","ceil","floor","column","getTileStyle","rectangle","display","backgroundImage","backgroundPosition","getTileDomElement","domElement","document","createElement","tileStyle","keys","styleProp","style","getImageData","setReferencePalette","green","blue","alpha","waitForLoading","addEventListener","Scene_1","enumerable","Sprite_1","Tilesheet_1"],"mappings":"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","file":"examples.8071e4ec.js","sourceRoot":"..\\examples","sourcesContent":["\"use strict\";\r\nvar __read = (this && this.__read) || function (o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n};\r\nvar __spread = (this && this.__spread) || function () {\r\n    for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction cloneDeepArrays(arraysToClone) {\r\n    return arraysToClone.map(function (arr) { return arr.slice(); });\r\n}\r\nvar Scene = (function () {\r\n    function Scene(tiles, canvas, timer) {\r\n        if (tiles === void 0) { tiles = []; }\r\n        if (canvas === void 0) { canvas = null; }\r\n        if (timer === void 0) { timer = window; }\r\n        this.animationClocks = [];\r\n        this.initialTiles = cloneDeepArrays(tiles);\r\n        this.tiles = cloneDeepArrays(tiles);\r\n        this.canvas = canvas;\r\n        this.timer = timer;\r\n    }\r\n    Scene.prototype.getWidth = function () {\r\n        var width = this.tilesheet.getTileSize().width;\r\n        var maxLength = Math.max.apply(Math, __spread(this.tiles.map(function (row) { return row.length; })));\r\n        return width * maxLength;\r\n    };\r\n    Scene.prototype.getHeight = function () {\r\n        var height = this.tilesheet.getTileSize().height;\r\n        return this.tiles.length * height;\r\n    };\r\n    Scene.prototype.getCanvas = function () {\r\n        return this.canvas;\r\n    };\r\n    Scene.prototype.setCanvas = function (canvas) {\r\n        this.canvas = canvas;\r\n        this.resizeCanvas();\r\n        return this;\r\n    };\r\n    Scene.prototype.resizeCanvas = function () {\r\n        if (this.canvas && this.tilesheet) {\r\n            this.canvas.width = this.getWidth();\r\n            this.canvas.height = this.getHeight();\r\n        }\r\n        return this;\r\n    };\r\n    Scene.prototype.setTile = function (x, y, newTile) {\r\n        this.tiles[y][x] = newTile;\r\n        return this;\r\n    };\r\n    Scene.prototype.renderTile = function (columnIndex, rowIndex, canvas, deltaX, deltaY) {\r\n        if (canvas === void 0) { canvas = this.canvas; }\r\n        if (deltaX === void 0) { deltaX = 0; }\r\n        if (deltaY === void 0) { deltaY = 0; }\r\n        var ctx = canvas.getContext('2d');\r\n        var tileIndex = this.tiles[rowIndex][columnIndex];\r\n        var _a = this.tilesheet.getTileRect(tileIndex), x = _a.x, y = _a.y, width = _a.width, height = _a.height;\r\n        var destX = columnIndex * width + deltaX;\r\n        var destY = rowIndex * height + deltaY;\r\n        if (tileIndex === null) {\r\n            ctx.clearRect(destX, destY, width, height);\r\n            return this;\r\n        }\r\n        ctx.drawImage(this.tilesheet.getImage(), x, y, width, height, destX, destY, width, height);\r\n        return this;\r\n    };\r\n    Scene.prototype.render = function (canvas, x, y) {\r\n        var _this = this;\r\n        if (canvas === void 0) { canvas = this.canvas; }\r\n        if (x === void 0) { x = 0; }\r\n        if (y === void 0) { y = 0; }\r\n        if (!this.tilesheet) {\r\n            throw new Error('Scene::render: tilesheet is not defined.');\r\n        }\r\n        if (!canvas) {\r\n            throw new Error('Scene::render: no canvas provided.');\r\n        }\r\n        this.canvas = canvas;\r\n        this.tiles.forEach(function (rowTiles, rowIndex) {\r\n            rowTiles.forEach(function (tileIndex, columnIndex) {\r\n                _this.renderTile(columnIndex, rowIndex, canvas, x, y);\r\n            });\r\n        });\r\n        return this;\r\n    };\r\n    Scene.prototype.resetTiles = function () {\r\n        this.tiles = cloneDeepArrays(this.initialTiles);\r\n        return this;\r\n    };\r\n    Scene.prototype.updateTilesFromArray = function (tiles, currentTileIndex, deltaX, deltaY) {\r\n        var _this = this;\r\n        if (deltaX === void 0) { deltaX = 0; }\r\n        if (deltaY === void 0) { deltaY = 0; }\r\n        var nextTileIndex = currentTileIndex + 1;\r\n        if (!tiles[nextTileIndex]) {\r\n            nextTileIndex = 0;\r\n        }\r\n        this.tiles.forEach(function (rowTiles, rowIndex) {\r\n            rowTiles.forEach(function (tileIndex, columnIndex) {\r\n                if (tileIndex !== tiles[currentTileIndex]) {\r\n                    return;\r\n                }\r\n                var newTile = tiles[nextTileIndex];\r\n                _this.setTile(columnIndex, rowIndex, newTile);\r\n                if (_this.canvas) {\r\n                    _this.renderTile(columnIndex, rowIndex, _this.canvas, deltaX, deltaY);\r\n                }\r\n            });\r\n        });\r\n        return nextTileIndex;\r\n    };\r\n    Scene.prototype.playAnimations = function (x, y) {\r\n        var _this = this;\r\n        if (x === void 0) { x = 0; }\r\n        if (y === void 0) { y = 0; }\r\n        this.stopAnimations();\r\n        this.animationClocks = this.tilesheet.getAnimations().map(function (animation) {\r\n            var tileIndex = 0;\r\n            return _this.timer.setInterval(function () {\r\n                tileIndex = _this.updateTilesFromArray(animation.tiles, tileIndex, x, y);\r\n            }, animation.speed);\r\n        });\r\n        return this;\r\n    };\r\n    Scene.prototype.stopAnimations = function () {\r\n        var _this = this;\r\n        this.animationClocks.forEach(function (clock) {\r\n            _this.timer.clearInterval(clock);\r\n        });\r\n        return this;\r\n    };\r\n    Scene.prototype.useTilesheet = function (tilesheet) {\r\n        this.tilesheet = tilesheet;\r\n        this.resizeCanvas();\r\n        this.playAnimations();\r\n        return this;\r\n    };\r\n    return Scene;\r\n}());\r\nexports.default = Scene;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Sprite = (function () {\r\n    function Sprite(canvas, timer) {\r\n        if (canvas === void 0) { canvas = null; }\r\n        if (timer === void 0) { timer = window; }\r\n        this.palette = null;\r\n        this.currentTileIndex = 0;\r\n        this.canvas = canvas;\r\n        this.timer = timer;\r\n    }\r\n    Sprite.prototype.setCanvas = function (canvas) {\r\n        this.canvas = canvas;\r\n        return this;\r\n    };\r\n    Sprite.prototype.setCurrentTile = function (tileIndex) {\r\n        this.currentTileIndex = tileIndex;\r\n        return this;\r\n    };\r\n    Sprite.prototype.stopAnimation = function () {\r\n        this.timer.clearInterval(this.animationClock);\r\n        return this;\r\n    };\r\n    Sprite.prototype.updateTilesFromArray = function (tiles, currentTileIndex, shouldLoop, onUpdate, onEnd, shouldRender) {\r\n        if (shouldLoop === void 0) { shouldLoop = false; }\r\n        if (onUpdate === void 0) { onUpdate = function () { }; }\r\n        if (onEnd === void 0) { onEnd = function () { }; }\r\n        if (shouldRender === void 0) { shouldRender = true; }\r\n        var nextTileIndex = currentTileIndex + 1;\r\n        if (!tiles[nextTileIndex]) {\r\n            nextTileIndex = 0;\r\n            if (!shouldLoop) {\r\n                onEnd();\r\n                this.stopAnimation();\r\n                return nextTileIndex;\r\n            }\r\n        }\r\n        var newTile = tiles[nextTileIndex];\r\n        onUpdate(newTile);\r\n        this.setCurrentTile(newTile);\r\n        if (shouldRender) {\r\n            this.render();\r\n        }\r\n        return nextTileIndex;\r\n    };\r\n    Sprite.prototype.playAnimation = function (name, shouldLoop, onUpdate, onEnd, shouldRender) {\r\n        var _this = this;\r\n        if (shouldLoop === void 0) { shouldLoop = true; }\r\n        if (onUpdate === void 0) { onUpdate = function () { }; }\r\n        if (onEnd === void 0) { onEnd = function () { }; }\r\n        if (shouldRender === void 0) { shouldRender = true; }\r\n        var animation = this.tilesheet.getAnimation(name);\r\n        if (!animation) {\r\n            throw new Error(\"Sprite::playAnimation: animation \\\"\" + name + \"\\\" not found\");\r\n        }\r\n        this.stopAnimation();\r\n        var currentAnimationIndex = 0;\r\n        var firstTile = animation.tiles[currentAnimationIndex];\r\n        onUpdate(firstTile);\r\n        this.setCurrentTile(firstTile);\r\n        if (shouldRender) {\r\n            this.render();\r\n        }\r\n        this.animationClock = this.timer.setInterval(function () {\r\n            currentAnimationIndex = _this.updateTilesFromArray(animation.tiles, currentAnimationIndex, shouldLoop, onUpdate, onEnd, shouldRender);\r\n        }, animation.speed);\r\n        return this;\r\n    };\r\n    Sprite.prototype.render = function (canvas, destX, destY) {\r\n        if (canvas === void 0) { canvas = this.canvas; }\r\n        if (destX === void 0) { destX = 0; }\r\n        if (destY === void 0) { destY = 0; }\r\n        var _a = this.tilesheet.getTileRect(this.currentTileIndex), x = _a.x, y = _a.y, width = _a.width, height = _a.height;\r\n        if (canvas === this.canvas) {\r\n            canvas.width = width;\r\n            canvas.height = height;\r\n        }\r\n        var ctx = canvas.getContext('2d');\r\n        ctx.drawImage(this.tilesheet.getImage(this.palette), x, y, width, height, destX, destY, width, height);\r\n        return this;\r\n    };\r\n    Sprite.prototype.usePalette = function (palette) {\r\n        this.palette = palette;\r\n        return this;\r\n    };\r\n    Sprite.prototype.useTilesheet = function (tilesheet) {\r\n        this.tilesheet = tilesheet;\r\n        this.stopAnimation();\r\n        return this;\r\n    };\r\n    return Sprite;\r\n}());\r\nexports.default = Sprite;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction areColorsEqual(color1, color2) {\r\n    return color1.every(function (value, index) { return value === color2[index]; });\r\n}\r\nvar Palette = (function () {\r\n    function Palette() {\r\n        this.colors = [];\r\n    }\r\n    Palette.prototype.addColor = function (color) {\r\n        if (this.hasColor(color)) {\r\n            return this;\r\n        }\r\n        this.colors.push(color);\r\n        return this;\r\n    };\r\n    Palette.prototype.hasColor = function (colorToFind) {\r\n        return this.colors.some(function (color) { return areColorsEqual(color, colorToFind); });\r\n    };\r\n    Palette.prototype.getColorByIndex = function (index) {\r\n        return this.colors[index];\r\n    };\r\n    Palette.prototype.getIndexFromColor = function (colorToFind) {\r\n        return this.colors.findIndex(function (color) { return areColorsEqual(color, colorToFind); });\r\n    };\r\n    return Palette;\r\n}());\r\nexports.default = Palette;\r\n","\"use strict\";\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nvar __read = (this && this.__read) || function (o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Palette_1 = require(\"./Palette\");\r\nvar Tilesheet = (function () {\r\n    function Tilesheet(imagePath, shouldAutoload) {\r\n        if (shouldAutoload === void 0) { shouldAutoload = true; }\r\n        this.tileWidth = 16;\r\n        this.tileHeight = 16;\r\n        this.margin = 1;\r\n        this.animations = [];\r\n        this.referencePalette = null;\r\n        this.palettedImages = new Map();\r\n        this.image = new Image();\r\n        this.imagePath = imagePath;\r\n        if (shouldAutoload) {\r\n            this.load();\r\n        }\r\n    }\r\n    Tilesheet.prototype.load = function () {\r\n        this.image.src = this.imagePath;\r\n        return this;\r\n    };\r\n    Tilesheet.prototype.getAnimations = function () {\r\n        return this.animations;\r\n    };\r\n    Tilesheet.prototype.getAnimation = function (name) {\r\n        return this.animations.filter(function (animation) { return animation.name === name; })[0];\r\n    };\r\n    Tilesheet.prototype.setAnimations = function (animations) {\r\n        this.animations = animations;\r\n        return this;\r\n    };\r\n    Tilesheet.prototype.getTileSize = function () {\r\n        return {\r\n            width: this.tileWidth,\r\n            height: this.tileHeight,\r\n        };\r\n    };\r\n    Tilesheet.prototype.setTileSize = function (width, height) {\r\n        if (height === void 0) { height = width; }\r\n        this.tileWidth = width;\r\n        this.tileHeight = height;\r\n        return this;\r\n    };\r\n    Tilesheet.prototype.setMargin = function (margin) {\r\n        this.margin = margin;\r\n        return this;\r\n    };\r\n    Tilesheet.prototype.generatePalettedImage = function (palette) {\r\n        if (!this.image.complete) {\r\n            throw new Error('Tilesheets::generatePalettedImage: image is not fully loaded yet.');\r\n        }\r\n        var referencePalette = this.getReferencePalette();\r\n        var _a = this.initNewCanvasWithImage(), palettedImage = _a.canvas, ctx = _a.ctx, imageData = _a.imageData;\r\n        var pixelData = imageData.data;\r\n        for (var i = 0, l = pixelData.length; i < l; i += 4) {\r\n            var red = pixelData[i];\r\n            var green = pixelData[i + 1];\r\n            var blue = pixelData[i + 2];\r\n            var alpha = pixelData[i + 3];\r\n            var color = [red, green, blue, alpha];\r\n            var index = referencePalette.getIndexFromColor(color);\r\n            if (index < 0) {\r\n                continue;\r\n            }\r\n            var _b = __read(palette.getColorByIndex(index), 4), newRed = _b[0], newGreen = _b[1], newBlue = _b[2], newAlpha = _b[3];\r\n            pixelData[i] = newRed;\r\n            pixelData[i + 1] = newGreen;\r\n            pixelData[i + 2] = newBlue;\r\n            pixelData[i + 3] = newAlpha;\r\n        }\r\n        ctx.putImageData(imageData, 0, 0);\r\n        this.palettedImages.set(palette, palettedImage);\r\n        return palettedImage;\r\n    };\r\n    Tilesheet.prototype.getImage = function (paletteToUse) {\r\n        if (!paletteToUse) {\r\n            return this.image;\r\n        }\r\n        if (!this.palettedImages.has(paletteToUse)) {\r\n            return this.generatePalettedImage(paletteToUse);\r\n        }\r\n        return this.palettedImages.get(paletteToUse);\r\n    };\r\n    Tilesheet.prototype.getTileRect = function (tileIndex) {\r\n        if (!this.image.complete) {\r\n            throw new Error('Tilesheets::getTileRect: image is not fully loaded yet.');\r\n        }\r\n        var naturalWidth = this.image.naturalWidth;\r\n        var totalTilesOnRow = Math.ceil(naturalWidth / (this.tileWidth + this.margin));\r\n        var row = Math.floor(tileIndex / totalTilesOnRow);\r\n        var column = tileIndex % totalTilesOnRow;\r\n        return __assign({ x: column * this.tileWidth + column * this.margin, y: row * this.tileHeight + row * this.margin }, this.getTileSize());\r\n    };\r\n    Tilesheet.prototype.getTileStyle = function (tileIndex) {\r\n        if (!this.image.complete) {\r\n            throw new Error('Tilesheets::getTileStyle: image is not fully loaded yet.');\r\n        }\r\n        var rectangle = this.getTileRect(tileIndex);\r\n        return {\r\n            display: 'inline-block',\r\n            width: rectangle.width + \"px\",\r\n            height: rectangle.height + \"px\",\r\n            backgroundImage: \"url(\" + this.image.src + \")\",\r\n            backgroundPosition: \"-\" + rectangle.x + \"px -\" + rectangle.y + \"px\",\r\n        };\r\n    };\r\n    Tilesheet.prototype.getTileDomElement = function (tileIndex) {\r\n        if (!this.image.complete) {\r\n            throw new Error('Tilesheets::getTileDomElement: image is not fully loaded yet.');\r\n        }\r\n        var domElement = document.createElement('span');\r\n        var tileStyle = this.getTileStyle(tileIndex);\r\n        Object.keys(tileStyle).forEach(function (styleProp) {\r\n            domElement.style[styleProp] = tileStyle[styleProp];\r\n        });\r\n        return domElement;\r\n    };\r\n    Tilesheet.prototype.initNewCanvasWithImage = function () {\r\n        var canvas = document.createElement('canvas');\r\n        var ctx = canvas.getContext('2d');\r\n        var _a = this.image, width = _a.width, height = _a.height;\r\n        canvas.width = width;\r\n        canvas.height = height;\r\n        ctx.drawImage(this.image, 0, 0, width, height);\r\n        var imageData = ctx.getImageData(0, 0, width, height);\r\n        return { canvas: canvas, ctx: ctx, imageData: imageData };\r\n    };\r\n    Tilesheet.prototype.getReferencePalette = function () {\r\n        if (!this.image.complete) {\r\n            throw new Error('Tilesheets::getReferencePalette: image is not fully loaded yet.');\r\n        }\r\n        if (this.referencePalette) {\r\n            return this.referencePalette;\r\n        }\r\n        this.setReferencePalette(new Palette_1.default());\r\n        var imageData = this.initNewCanvasWithImage().imageData;\r\n        var pixelData = imageData.data;\r\n        for (var i = 0, l = pixelData.length; i < l; i += 4) {\r\n            var red = pixelData[i];\r\n            var green = pixelData[i + 1];\r\n            var blue = pixelData[i + 2];\r\n            var alpha = pixelData[i + 3];\r\n            this.referencePalette.addColor([red, green, blue, alpha]);\r\n        }\r\n        return this.referencePalette;\r\n    };\r\n    Tilesheet.prototype.setReferencePalette = function (palette) {\r\n        this.referencePalette = palette;\r\n        return this;\r\n    };\r\n    Tilesheet.prototype.waitForLoading = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                if (this.image.src && this.image.complete) {\r\n                    return [2];\r\n                }\r\n                return [2, new Promise(function (resolve, reject) {\r\n                        _this.image.addEventListener('load', resolve);\r\n                        _this.image.addEventListener('error', reject);\r\n                    })];\r\n            });\r\n        });\r\n    };\r\n    return Tilesheet;\r\n}());\r\nexports.default = Tilesheet;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Scene_1 = require(\"./src/models/Scene\");\r\nObject.defineProperty(exports, \"Scene\", { enumerable: true, get: function () { return Scene_1.default; } });\r\nvar Sprite_1 = require(\"./src/models/Sprite\");\r\nObject.defineProperty(exports, \"Sprite\", { enumerable: true, get: function () { return Sprite_1.default; } });\r\nvar Tilesheet_1 = require(\"./src/models/Tilesheet\");\r\nObject.defineProperty(exports, \"Tilesheet\", { enumerable: true, get: function () { return Tilesheet_1.default; } });\r\n","import { Sprite } from '../../';\r\n\r\nexport default (sheet, palettes) => {\r\n    const faviconCanvas = document.createElement('canvas');\r\n    faviconCanvas.width = 16;\r\n    faviconCanvas.height = 16;\r\n    const faviconCtx = faviconCanvas.getContext('2d');\r\n\r\n    const canvas = document.createElement('canvas');\r\n    const sprite = new Sprite(canvas);\r\n\r\n    const link = document.createElement('link');\r\n    link.type = 'image/x-icon';\r\n    link.rel = 'shortcut icon';\r\n\r\n    document.getElementsByTagName('head')[0].appendChild(link);\r\n\r\n    document.body.addEventListener('click', (e) => {\r\n        const target = e.target as HTMLButtonElement;\r\n\r\n        if (!target.dataset.palette) {\r\n            return;\r\n        }\r\n\r\n        sprite.usePalette(palettes[target.dataset.palette]).render();\r\n        renderFavicon();\r\n       \r\n        e.preventDefault();\r\n    });\r\n\r\n    function renderFavicon() {\r\n        faviconCtx.clearRect(0, 0, 16, 16);\r\n        faviconCtx.drawImage(canvas, 0, 0);\r\n        link.href = faviconCanvas.toDataURL();\r\n    }\r\n\r\n    sprite\r\n        .useTilesheet(sheet)\r\n        .usePalette(palettes[1])\r\n        .playAnimation('hourray');\r\n\r\n    window.setInterval(renderFavicon, 300);\r\n    renderFavicon();\r\n};","import { Sprite } from '../../';\r\n\r\nexport default (sheetSpring, sheetFall) => {\r\n    const bushTile = sheetSpring.getTileDomElement(5);\r\n    document.getElementById('bush_sample').appendChild(bushTile);\r\n\r\n    const bush = new Sprite(document.getElementById('canvas_bush_sample') as HTMLCanvasElement);\r\n    bush\r\n        .useTilesheet(sheetSpring)\r\n        .setCurrentTile(5)\r\n        .render();\r\n\r\n    const bush2 = new Sprite(document.getElementById('canvas_bush_sample2') as HTMLCanvasElement);\r\n    bush2\r\n        .useTilesheet(sheetFall)\r\n        .setCurrentTile(5)\r\n        .render();\r\n};","export default (sheetSpring) => {\r\n    const table = document.getElementById('tilesheet_index_sample');\r\n    \r\n    table.style.backgroundImage = `linear-gradient(rgba(255, 255, 255, .7), rgba(255, 255, 255, .7)), url(${sheetSpring.image.src})`;\r\n    table.style.width = `${sheetSpring.image.naturalWidth}px`;\r\n    table.style.height = `${sheetSpring.image.naturalHeight}px`;\r\n\r\n    const rowsFragment = document.createDocumentFragment();\r\n    let tileIndex = 0;\r\n    \r\n    for (let row = 0; row <= 7; row++) {\r\n        const columnsFragment = document.createDocumentFragment();\r\n\r\n        for (let column = 0; column <= 6; column++) {\r\n            const td = document.createElement('td');\r\n            td.appendChild(document.createTextNode(`${tileIndex}`));\r\n            columnsFragment.appendChild(td);\r\n            tileIndex++;\r\n        }\r\n\r\n        const tr = document.createElement('tr');\r\n        tr.appendChild(columnsFragment);\r\n\r\n        rowsFragment.appendChild(tr);\r\n    }\r\n\r\n    table.appendChild(rowsFragment);\r\n};","import { Scene } from '../../';\r\n\r\nexport default (sheetSpring, sheetSummer, sheetFall, sheetWinter) => {\r\n    const scene = new Scene([\r\n        [28, 29, 28, 29, 21, 22, 28, 29, 21, 22, 21, 22, 28, 29,  0,  0, 11, 42, 47, 47],\r\n        [ 8, 25, 26, 27, 28, 29,  5,  5, 28, 29, 28, 29,  5,  5,  5,  6,  5, 42, 47, 47],\r\n        [ 4, 32, 33, 34, 21, 22,  8,  8,  2,  3,  4, 21, 22, 17, 13,  5,  5, 42, 47, 47],\r\n        [17, 14, 14, 14, 28, 29,  8,  8,  9, 10,  7, 28, 29, 36, 36, 36, 36, 51, 47, 47],\r\n        [21, 22, 23, 24, 13, 13,  3,  3, 10, 10,  0, 11, 42, 38, 38, 38, 47, 47, 47, 47],\r\n        [28, 29, 30, 31, 13, 21, 22,  6,  1, 10,  0, 11, 42, 38, 38, 38, 47, 47, 47, 47],\r\n        [22,  2,  3,  3,  7, 28, 29,  6,  1,  7,  7, 18, 42, 45, 46, 45, 35, 50, 50, 50],\r\n        [29, 16,  7,  7,  0,  1,  1, 21, 22, 21, 22,  8, 42, 45, 45, 46, 44,  8,  8,  8],\r\n        [21, 22,  9,  0,  0,  0,  7, 28, 29, 28, 29, 21, 22, 50, 50, 50,  8,  2,  3,  3],\r\n    ], document.getElementById('canvas_advanced') as HTMLCanvasElement);\r\n\r\n    let activeButton: HTMLButtonElement;\r\n\r\n    function switchSeason(season) {\r\n        const seasonToTilesheet = {\r\n            spring: sheetSpring,\r\n            summer: sheetSummer,\r\n            fall: sheetFall,\r\n            winter: sheetWinter,\r\n        };\r\n\r\n        activeButton = document.querySelector(`[data-season=\"${season}\"]`);\r\n        activeButton.disabled = true;\r\n        activeButton.classList.add('is-outlined');\r\n\r\n        scene\r\n            .resetTiles()\r\n            .useTilesheet(seasonToTilesheet[season])\r\n            .render();\r\n    }\r\n\r\n    document.body.addEventListener('click', (e) => {\r\n        const target = e.target as HTMLButtonElement;\r\n\r\n        if (!target.dataset.season) {\r\n            return;\r\n        }\r\n\r\n        activeButton.disabled = false;\r\n        activeButton.classList.remove('is-outlined');\r\n\r\n        switchSeason(target.dataset.season);\r\n       \r\n        e.preventDefault();\r\n    });\r\n\r\n    switchSeason('spring');\r\n};","import { Scene } from '../../';\r\n\r\nexport default (sheetSpring, sheetWinter) => {\r\n    const tiles = [\r\n        [21, 22, 23, 24,  9],\r\n        [28, 29, 30, 31,  9],\r\n        [22,  5,  3,  6, 10],\r\n        [29,  5, 17, 17, 18],\r\n    ];\r\n\r\n    const springSceneCanvas = document.getElementById('scene_sample') as HTMLCanvasElement;\r\n    const mySpringScene = new Scene(tiles, springSceneCanvas);\r\n\r\n    mySpringScene\r\n        .useTilesheet(sheetSpring)\r\n        .render();\r\n\r\n    const winterSceneCanvas = document.getElementById('scene_sample_winter') as HTMLCanvasElement;\r\n    const myWinterScene = new Scene(tiles, winterSceneCanvas);\r\n\r\n    myWinterScene\r\n        .useTilesheet(sheetWinter)\r\n        .render();\r\n\r\n    const tilesWithSomeAnimation = [\r\n        [ 1,  1,  1,  1,  1],\r\n        [17, 17, 17, 17, 17],\r\n        [36, 36, 36, 36, 36],\r\n        [38, 38, 38, 38, 38],\r\n    ];\r\n\r\n    const animatedSceneCanvas = document.getElementById('scene_sample_animation') as HTMLCanvasElement;\r\n    const myAnimatedScene = new Scene(tilesWithSomeAnimation, animatedSceneCanvas);\r\n\r\n    myAnimatedScene\r\n        .useTilesheet(sheetSpring)\r\n        .render();\r\n};","import { Sprite } from '../../';\r\n\r\nexport default (sheetSpring) => {\r\n    const flowers = new Sprite(document.getElementById('canvas_sprite_animated') as HTMLCanvasElement);\r\n    \r\n    flowers\r\n        .useTilesheet(sheetSpring)\r\n        .playAnimation('flower')\r\n        .render();\r\n\r\n    const advancedSprite = new Sprite(document.getElementById('canvas_sprite_animated_advanced') as HTMLCanvasElement);\r\n    advancedSprite.useTilesheet(sheetSpring);\r\n\r\n    let activeButton: HTMLButtonElement;\r\n\r\n    function switchAnimation(newAnimation) {\r\n        const possibleAnimations = ['water', 'flower'];\r\n\r\n        activeButton = document.querySelector(`[data-animation=\"${newAnimation}\"]`);\r\n        activeButton.disabled = true;\r\n        activeButton.classList.add('is-outlined');\r\n    \r\n        if (possibleAnimations.indexOf(newAnimation) >= 0) {\r\n            advancedSprite.playAnimation(newAnimation).render();\r\n        } else {\r\n            advancedSprite.stopAnimation();\r\n        }\r\n    }\r\n\r\n    document.body.addEventListener('click', (e) => {\r\n        const target = e.target as HTMLButtonElement;\r\n\r\n        if (!target.dataset.animation) {\r\n            return;\r\n        }\r\n\r\n        activeButton.disabled = false;\r\n        activeButton.classList.remove('is-outlined');\r\n\r\n        switchAnimation(target.dataset.animation);\r\n       \r\n        e.preventDefault();\r\n    });\r\n\r\n    switchAnimation('flower');\r\n};","import { Sprite } from '../../';\r\n\r\nexport default async (sheetYoshi, palettes) => {\r\n    const spriteYoshiAnimated = new Sprite(document.getElementById('canvas_sprite_yoshi_animated') as HTMLCanvasElement);\r\n    spriteYoshiAnimated.useTilesheet(sheetYoshi).playAnimation('hourray'); \r\n    \r\n    const spriteYellowYoshiAnimated = new Sprite(document.getElementById('canvas_sprite_yellow_yoshi_animated') as HTMLCanvasElement);\r\n    spriteYellowYoshiAnimated.useTilesheet(sheetYoshi).usePalette(palettes[1]).playAnimation('hourray'); \r\n\r\n    const palettedSprite = new Sprite(document.getElementById('canvas_paletted_sprite') as HTMLCanvasElement);\r\n    \r\n    let activeButton: HTMLButtonElement;\r\n\r\n    function switchPalette(newPalette) {\r\n        activeButton = document.querySelector(`[data-palette=\"${newPalette}\"]`);\r\n        activeButton.disabled = true;\r\n        activeButton.classList.add('is-outlined');\r\n    \r\n        palettedSprite.usePalette(palettes[newPalette]).render();\r\n    }\r\n\r\n    document.body.addEventListener('click', (e) => {\r\n        const target = e.target as HTMLButtonElement;\r\n\r\n        if (!target.dataset.palette) {\r\n            return;\r\n        }\r\n\r\n        activeButton.disabled = false;\r\n        activeButton.classList.remove('is-outlined');\r\n\r\n        switchPalette(target.dataset.palette);\r\n       \r\n        e.preventDefault();\r\n    });\r\n\r\n    palettedSprite.useTilesheet(sheetYoshi).playAnimation('hourray'); \r\n    \r\n    switchPalette(1);\r\n};","import { Tilesheet } from '../';\r\n\r\nimport favicon from './scripts/favicon';\r\nimport tilesheetBushSample from './scripts/tilesheet_bush';\r\nimport tilesheetIndexSample from './scripts/tilesheet_index_sample';\r\nimport tilesheetAdvanced from './scripts/tilesheet_advanced';\r\nimport sceneSample from './scripts/scene_sample';\r\nimport spriteAnimated from './scripts/sprite_animated';\r\nimport palettedSprite from './scripts/paletted_sprite';\r\nimport imageSpring from './images/spring.png';\r\nimport imageSummer from './images/summer.png';\r\nimport imageFall from './images/fall.png';\r\nimport imageWinter from './images/winter.png';\r\nimport imageYoshi from './images/yoshi.png';\r\nimport imageBlueYoshiPalette from './images/blue_yoshi_palette.png';\r\nimport imageGreenYoshiPalette from './images/green_yoshi_palette.png';\r\nimport imageRedYoshiPalette from './images/red_yoshi_palette.png';\r\nimport imageYellowYoshiPalette from './images/yellow_yoshi_palette.png';\r\nimport imageCustomYoshiPalette from './images/custom_yoshi_palette.png';\r\n\r\n(async () => {\r\n    const sheetSpring = new Tilesheet(imageSpring);\r\n    const sheetSummer = new Tilesheet(imageSummer);\r\n    const sheetFall = new Tilesheet(imageFall);\r\n    const sheetWinter = new Tilesheet(imageWinter);\r\n    const sheetYoshi = new Tilesheet(imageYoshi);\r\n    const sheetGreenYoshiPalette = new Tilesheet(imageGreenYoshiPalette);\r\n    const sheetYellowYoshiPalette = new Tilesheet(imageYellowYoshiPalette);\r\n    const sheetRedYoshiPalette = new Tilesheet(imageRedYoshiPalette);\r\n    const sheetBlueYoshiPalette = new Tilesheet(imageBlueYoshiPalette);\r\n    const sheetCustomYoshiPalette = new Tilesheet(imageCustomYoshiPalette);\r\n\r\n    const animationSpeed = 300;\r\n    const waterAnimation = {\r\n        tiles: [38, 39, 40, 41],\r\n        speed: animationSpeed,\r\n        name: 'water',\r\n    };\r\n    const driedWater1Animation = {\r\n        tiles: [45, 39],\r\n        speed: animationSpeed,\r\n    };\r\n    const driedWater2Animation = {\r\n        tiles: [46, 39],\r\n        speed: animationSpeed,\r\n    };\r\n    const frozenWaterAnimation = {\r\n        tiles: [47, 39],\r\n        speed: animationSpeed,\r\n    };\r\n    const flowersAnimation = {\r\n        tiles: [1, 12, 19, 20],\r\n        speed: animationSpeed,\r\n        name: 'flower',\r\n    };\r\n    const yoshiAnimation = {\r\n        tiles: [0, 1],\r\n        speed: animationSpeed,\r\n        name: 'hourray',\r\n    };\r\n\r\n    sheetSpring.setAnimations([waterAnimation, driedWater1Animation, driedWater2Animation, frozenWaterAnimation, flowersAnimation]);\r\n    sheetSummer.setAnimations([waterAnimation, frozenWaterAnimation, flowersAnimation]);\r\n    sheetFall.setAnimations([waterAnimation, driedWater1Animation, driedWater2Animation, frozenWaterAnimation]);\r\n    sheetWinter.setAnimations([waterAnimation, driedWater1Animation, driedWater2Animation]);\r\n    sheetYoshi.setAnimations([yoshiAnimation]);\r\n\r\n    const allSheets = [sheetSpring, sheetSummer, sheetFall, sheetWinter];\r\n    const paletteSheets = [sheetGreenYoshiPalette, sheetYellowYoshiPalette, sheetRedYoshiPalette, sheetBlueYoshiPalette, sheetCustomYoshiPalette];\r\n    \r\n    allSheets.forEach((sheet) => {\r\n        sheet.setTileSize(16).setMargin(1);\r\n    });\r\n    paletteSheets.forEach((sheet) => {\r\n        sheet.setTileSize(5).setMargin(0);\r\n    });\r\n    sheetYoshi.setTileSize(25, 32).setMargin(1);\r\n    \r\n    allSheets.push(sheetYoshi, ...paletteSheets);\r\n\r\n    await Promise.all(allSheets.map(sheet => sheet.waitForLoading()));\r\n    sheetYoshi.setReferencePalette(sheetGreenYoshiPalette.getReferencePalette());\r\n\r\n    const yoshiPalettes = paletteSheets.map(palette => palette.getReferencePalette());\r\n\r\n    favicon(sheetYoshi, yoshiPalettes);\r\n    tilesheetIndexSample(sheetSpring);\r\n    tilesheetBushSample(sheetSpring, sheetFall);\r\n    spriteAnimated(sheetSpring);\r\n    palettedSprite(sheetYoshi, yoshiPalettes);\r\n    sceneSample(sheetSpring, sheetWinter);\r\n    tilesheetAdvanced(sheetSpring, sheetSummer, sheetFall, sheetWinter);    \r\n})();"]}